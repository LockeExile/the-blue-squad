<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>The Blue Squad</title>
    
    <!-- Material Design Theming -->
    <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.orange-indigo.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>

    <link rel="stylesheet" href="main.css">

    <!-- Firebase SDK -->
    <script defer src="/__/firebase/4.2.0/firebase-app.js"></script>
    <script defer src="/__/firebase/4.2.0/firebase-auth.js"></script>
    <!--script defer src="/__/firebase/4.2.0/firebase-database.js"></script-->
    <!--script defer src="/__/firebase/4.2.0/firebase-storage.js"></script-->
    <script defer src="/__/firebase/init.js"></script>
  </head>

  <body>
    <div class="mdl-layout mdl-js-layout">
      <header class="mdl-layout__header mdl-layout__header--waterfall">
        <div class="mdl-layout__header-row">
          <span class="mdl-layout-title">The Blue Squad</span>
          <div class="mdl-layout-spacer"></div>
          <img id="user-icon" style="display: none;" />
          <span id="user-name">Guest</span>
          <button disabled id="user-menu" class="mdl-button mdl-js-button mdl-button--icon">
            <i class="material-icons">more_vert</i>
          </button>
          <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="user-menu">
            <li id="sign-in" class="mdl-menu__item">Sign in with Twitter</li>
          </ul>
        </div>
      </header>

      <main class="mdl-layout__content">
        <div class="page-content">
          <div id="message">
            <h2>Welcome</h2>
            <h1>The Blue Squad currently in training</h1>
            <p>We're still working on setting up the site, so please check back later!</p>
          </div>
        </div>
      </main>
    </div>

    <script>
      function toggleSignIn() {
        document.getElementById('user-menu').disabled = true;
        if (!firebase.auth().currentUser) {
          let provider = new firebase.auth.TwitterAuthProvider();
          firebase.auth().signInWithRedirect(provider);
        } else {
          firebase.auth().signOut();
        }
      }

      function initApp() {
        firebase.auth().getRedirectResult().then(function(result) {
          // let token = result.credential.accessToken;
          // let secret = result.credential.secret;
          // let user = result.user;
        });

        firebase.auth().onAuthStateChanged(function(user) {
          if (user) { // User is signed in.
            document.getElementById('user-icon').src = user.photoURL;
            document.getElementById('user-icon').style.display = "inline-block";
            document.getElementById('user-name').textContent = user.displayName;
            document.getElementById('sign-in').textContent = 'Sign out';
          } else { // User is signed out.
            document.getElementById('user-icon').style.display = "none";
            document.getElementById('user-icon').src = "";
            document.getElementById('user-name').textContent = 'Guest';
            document.getElementById('sign-in').textContent = 'Sign in with Twitter';
          }

          document.getElementById('user-menu').disabled = false;
        });

        document.getElementById('sign-in').addEventListener('click', toggleSignIn, false);
      }

      document.addEventListener('DOMContentLoaded', initApp);
    </script>
  </body>
</html>
